import{a as c}from"./index-C4xxlH8f-1.js";import"./_commonjsHelpers-BosuxZz1-1.js";class f{constructor(i){this.apiConfig=i,sessionStorage.getItem("pscfgoverride")&&(this.overrideConfig=JSON.parse(sessionStorage.getItem("pscfgoverride"))),c.get(`${this.apiConfig.baseUrl}/api/v3/config`,{params:this.commonParams()}).then(r=>{let e={couponUrl:r.data.coupon_url,direct:r.data.direct,directUrl:r.data.direct_url,indirect:r.data.indirect,indirectUrl:r.data.indirect_url,provider:r.data.provider};this.overrideConfig&&(console.debug("before ps cfg override",e),e={...e,...this.overrideConfig},console.debug("after ps cfg override",e)),this.serviceConfig=e})}ready(){return!!this.serviceConfig}couponInfo(i){var e;if(!i.coupon)return null;let r={code:i.coupon.code,expDate:i.coupon.exp_date,percent:i.coupon.percent};return(e=this.overrideConfig)!=null&&e.coupon&&(r={...i,...this.overrideConfig.coupon}),r}couponUrl(){const i=new URLSearchParams({...this.commonParams(),"c[pl]":"coupon"});return`${this.serviceConfig.couponUrl}?${i.toString()}`}directUrl({backfillImageUrl:i,padWithTerms:r,page:e,placement:n,perPage:a,searchTerm:s}){const t=new URLSearchParams({...this.commonParams(),pp:80});return i&&t.set("biu",i),r&&t.set("pt",r),e&&t.set("p",e),a&&t.set("pp",a),n&&t.set("c[pl]",n),s&&t.set("t",s),`${this.serviceConfig.directUrl}?${t.toString()}`}indirectUrl({placement:i,searchTerm:r}){const e=new URLSearchParams({...this.commonParams()});return i&&e.set("c[pl]",i),r&&e.set("t",r),`${this.serviceConfig.indirectUrl}?${e.toString()}`}partnerConfig(i){var e;const r=this.apiConfig.partners[i];return{...r,name:(r==null?void 0:r.name)||this.provider(),logo_path:(e=r==null?void 0:r.logo_path)==null?void 0:e.replace("frontend/components/partner/img/","")}}provider(){var i;return(i=this.serviceConfig)==null?void 0:i.provider}showDirect(){var i;return(i=this.serviceConfig)==null?void 0:i.direct}showIndirect(){var i;return(i=this.serviceConfig)==null?void 0:i.indirect}commonParams(){var r;const i={ct:this.apiConfig.params.contentType,h:window.location.hostname,l:this.apiConfig.params.locale,pv:this.apiConfig.params.pageviewGuid,sg:this.apiConfig.params.sessionGuid,s:this.apiConfig.params.site};return this.pageKey()&&(i["c[pk]"]=this.pageKey()),this.apiConfig.params.searchTerm&&(i.t=this.apiConfig.params.searchTerm),this.apiConfig.params.splitTestName&&(i["c[st]"]=this.apiConfig.params.splitTestName),this.apiConfig.params.splitTestVariant&&(i["c[sv]"]=this.apiConfig.params.splitTestVariant),(r=this.overrideConfig)!=null&&r.provider&&(i["c[p]"]=this.overrideConfig.provider),i}pageKey(){if(!this.apiConfig.params.pageKey)return null;switch(this.apiConfig.params.pageKey){case"searches":return"search";case"resources":return"show";default:return null}}}function p(){if(window.partnerService)return;const o=document.getElementById("partner-service-api-config");if(!o)return;const i=JSON.parse(o.textContent);window.partnerService=new f(i)}p();window.addEventListener("turbo:visit",()=>{window.partnerService=null});window.addEventListener("turbo:load",p);
