import{r as k}from"./stimulus-helpers-d189GC1Y-1.js";import{E as n}from"./ez-base-controller-CGJ-YSBe-1.js";import{s as a,b5 as _,aq as M,r as I,p as y,f as O,J as N,t as S,k as P,b6 as F,b7 as H,b8 as q,b9 as A,ba as w,bb as x,bc as R,bd as B,be as U,bf as K}from"./tracking-Lad8KHcD-1.js";import{M as L}from"./media-matcher-vK8K0PVe-1.js";import{a as $}from"./ajax-helpers-CufTf_0G-1.js";import{a as D}from"./js-Cz0CWeBA-1.js";import"./performance-helpers-DpsuwFL7-1.js";import"./helpers-AnDMAI8W-1.js";import"./init-user-BlDnuGFC-1.js";import"./index-C4xxlH8f-1.js";import"./_commonjsHelpers-BosuxZz1-1.js";import"./modal_helpers-DIh0v7GJ-1.js";import"https://cdn.jsdelivr.net/npm/comlink/dist/esm/comlink.mjs";const o=new L,h=class h extends n{constructor(){super(...arguments),this.isVisible=e=>!!(e&&(e.offsetWidth||e.offsetHeight||e.getClientRects().length)),this.trackExploreClick=e=>{a({element:e.target,data:{action:_,label:`Link-${e.target.dataset.englishLabel}`,content_type:`Content-${e.target.dataset.contentType}`}})}}connect(){this.hasMobileMenuTarget&&(this.setupSearchCloseQueries(),o.evaluateAll(),o.addListeners())}disconnect(){o.removeListeners(),o.clearQueries()}clearSearchInput(){requestAnimationFrame(()=>{this.searchField.value="",this.searchField.focus()})}hideOnClickOutside(){const e=s=>{!this.element.contains(s.target)&&this.isVisible(this.element)&&(requestAnimationFrame(()=>{document.body.classList.toggle("is-mobile-search")}),t())},t=()=>{document.removeEventListener("click",e)};setTimeout(()=>{document.addEventListener("click",e)},50)}toggleMobileSearch(){const e=document.body;requestAnimationFrame(()=>{e.classList.toggle("is-mobile-search"),e.classList.contains("is-mobile-search")?(this.hideOnClickOutside(),requestAnimationFrame(()=>{this.savedVal=this.searchField.value,this.searchField.focus(),this.searchField.value="",this.searchField.value=this.savedVal})):requestAnimationFrame(()=>{this.searchField.value="",this.searchField.value=this.savedVal})})}setupSearchCloseQueries(){o.addMediaQuery("(max-width: 635px)",null,()=>{document.querySelector(".ez-dark-overlay.mobile-search-overlay")&&this.toggleMobileSearch()})}rebuyCredits(e){a({element:e.currentTarget,data:{action:M}})}headerLogin(){a({element:this.loginButtonTarget,data:{action:I}})}headerSignUp(){a({element:this.signupButtonTarget,data:{action:y}})}sendHeaderJoinProEvent(e){const t=O(e.target);a({element:e.target,data:{action:N,category:t}}),S({action:P,category:t})}get searchField(){return this.element.querySelector(".ez-search-form__input")}};h.targets=["mobileMenu","loginButton","signupButton"];let l=h;class X extends n{constructor(){super(...arguments),this.actionsMap={bundles:F,photos:H,vectors:q,videos:A,png:w,psd:x,svg:R,editor_template:B}}trackMenuClick({target:e,params:t}){const{contentType:s}=t,i=this.getTrackingContentType(s,e);a({data:{action:this.actionsMap[i],label:"menu",category:"Header"}})}trackExploreCategoryClick({target:e,params:t}){const{category:s,contentType:i}=t,r=this.getTrackingContentType(i,e);a({data:{action:this.actionsMap[r],label:`search-${s}`,category:"Header"}})}trackExploreLinkClick({target:e,params:t}){const{linkTitle:s,contentType:i}=t,r=this.getTrackingContentType(i,e);a({data:{action:this.actionsMap[r],label:`link-${s}`,category:"Header"}})}getTrackingContentType(e,t){if(e&&Object.prototype.hasOwnProperty.call(this.actionsMap,e))return e;const s=t.closest(".ez-drop-down__title")||t.closest(".mobile-menu-group__title");return s==null?void 0:s.dataset.title}}const c=new L,g=class g extends n{constructor(){super(...arguments),this.addParentNavHover=()=>{this.hasItemNavTarget&&this.itemNavTarget.addEventListener("mouseleave",this.leavingSubmenuParent)},this.removeParentNavHover=()=>{this.hasItemNavTarget&&this.itemNavTarget.removeEventListener("mouseleave",this.leavingSubmenuParent)},this.addMenuHovers=()=>{this.itemTargets.forEach(e=>{e.addEventListener("mouseenter",this.enterMenuItem),e.addEventListener("mouseleave",this.leaveMenuItem)})},this.removeMenuHovers=()=>{this.itemTargets.forEach(e=>{e.removeEventListener("mouseenter",this.enterMenuItem),e.removeEventListener("mouseleave",this.leaveMenuItem)})},this.enterMenuItem=e=>{e.currentTarget.classList.add("is-hovered"),e.target.parentElement.classList.contains("is-hovered")?e.target.classList.contains("is-hovered")&&requestAnimationFrame(()=>{e.target.classList.add("is-active")}):setTimeout(()=>{e.target.classList.contains("is-hovered")&&requestAnimationFrame(()=>{e.target.classList.add("is-active"),e.target.parentElement.classList.add("is-hovered")})},375)},this.leaveMenuItem=e=>{requestAnimationFrame(()=>{e.target.classList.remove("is-hovered","is-active")}),e.target.querySelector(".ez-drop-down__submenu")&&this.itemNavTarget.addEventListener("mouseleave",this.leavingSubmenuParent)},this.leavingSubmenuParent=e=>{requestAnimationFrame(()=>{e.target.classList.remove("is-hovered")})}}connect(){this.setupMenuMediaQueries(),c.evaluateAll(),c.addListeners()}disconnect(){c.removeListeners(),c.clearQueries()}setupMenuMediaQueries(){c.addMediaQuery("(min-width: 801px)",()=>{this.addMenuHovers(),this.addParentNavHover()},()=>{this.removeMenuHovers(),this.removeParentNavHover()})}};g.targets=["itemNav","item"];let d=g;const v=class v extends n{constructor(){super(...arguments),this.hideMenuItems=e=>{this.menuItemTargets.forEach(t=>{t!==e&&requestAnimationFrame(()=>{t.classList.remove("is-active")})})}}connect(){new window.SiteHeaderDecorator().init({context:this.element}),window.addEventListener("CloseExploreSubMenus",this.hideMenuItems)}disconnect(){window.removeEventListener("CloseExploreSubMenus",this.hideMenuItems)}menuItemClicked(e){const t=e.currentTarget.closest(".mobile-menu-group__title");requestAnimationFrame(()=>{t.classList.contains("is-active")?document.querySelector("body").classList.remove("has-active-mobile-submenu"):document.querySelector("body").classList.add("has-active-mobile-submenu"),t.classList.toggle("is-active")}),this.hideMenuItems(t)}};v.targets=["menuItem"];let u=v;class J extends n{connect(){new window.SiteHeaderDecorator().init({context:this.element})}}const p=class p extends n{connect(){this.contentRequested=!1,this.seenCookieUpdated=!1,this.activeIds=JSON.parse(this.unseenBadgeTarget.dataset.activeNotifications),this.seenIds=JSON.parse(this.unseenBadgeTarget.dataset.seenNotifications),this.flagLoaded()}getMarketingNotifications(){this.contentRequested||(this.contentRequested=!0,$("/api/v2/marketing_notifications",e=>{this.setNotifications(e.data.marketing_notifications)},e=>{console.error(e)}))}setNotifications(e){if(this.spinnerTarget.classList.add("is-hidden"),e.length===0){this.noNotifications();return}e.forEach((t,s)=>{const i=this.marketingTemplate(t,s+1);requestAnimationFrame(()=>{this.listTarget.insertAdjacentHTML("beforeend",i)})})}noNotifications(){const e=`
      <li class="notification-item no-notifications">
        <h3>Currently no notifications</h3>
        <p>Please check back later</p>
      </li>
    `;requestAnimationFrame(()=>{this.listTarget.insertAdjacentHTML("beforeend",e)})}menuClick(e){e.currentTarget.parentNode.classList.contains("is-closed")&&(this.getMarketingNotifications(),this.seenCookieUpdated||(this.seenCookieUpdated=!0,this.updateSeenCookie()),this.sendOpenClick(e,this.activeIds.length))}updateSeenCookie(){const e=this.seenIds;if(this.activeIds){this.activeIds.forEach(s=>{e.includes(s)||e.push(s)});let t=0;for(;t<e.length&&!(e.length<=100);)this.activeIds.indexOf(e[t])===-1&&(e.splice(t,1),t-=1),t+=1;D.set("seen_notifications",JSON.stringify(e)),this.setSeenBadge()}}sendOpenClick(e,t){a({element:e.currentTarget,data:{action:U,category:"Header",value:t}})}sendCompleteEvent(e){a({element:e.currentTarget,data:{action:K,category:"Header",label:e.currentTarget.dataset.trackingLabel,value:parseInt(e.currentTarget.dataset.position,10)}})}marketingTemplate(e,t){const{id:s,title:i,url:r,new_tab:C,image:E,button_text:b}=e,T=`
      href="${r}"
      data-action="click->notifications-menu#sendCompleteEvent"
      data-tracking-label="${i}"
      data-position="${t}"
      ${C?'target="_blank"':""}
    `;return`
      <li class="notification-item marketing-notification" data-id="${s}">
        <a ${T}>
          <img src="${E.large.url}" onerror="this.remove();" />
          <h6 class="marketing-notification__title">${i}</h6>
          <button class="ez-btn ez-btn--medium marketing-notification__btn">${b}</button>
        </a>
      </li>
    `}setSeenBadge(){requestAnimationFrame(()=>{this.unseenBadgeTarget.innerHTML="",this.unseenBadgeTarget.classList.add("is-hidden")})}};p.targets=["menuButton","list","unseenBadge","spinner"];let m=p;k([["site-header",l],["menu-tracking",X],["explore-nav",d],["mobile-menu",u],["user-menu",J],["notifications-menu",m]]);
